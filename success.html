<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Payment Success - Google</title>
  <!-- Load Roboto font -->
  <link href="https://fonts.googleapis.com/css2?family=Roboto&display=swap" rel="stylesheet" />
  <style>
    body {
      font-family: "Roboto", sans-serif;
      background-color: #f1f3f4;
      margin: 0;
      padding: 0;
    }
    .container {
      max-width: 520px;
      margin: 60px auto;
      background: #fff;
      box-shadow: 0 6px 16px rgba(0, 0, 0, 0.1);
      border-radius: 12px;
      padding: 30px;
      text-align: center;
    }
    .logo {
      margin-bottom: 20px;
      cursor: pointer;
    }
    .logo img {
      width: 100px;
    }
    .success {
      font-size: 20px;
      color: #34a853;
      margin-bottom: 20px;
    }
    .details {
      font-size: 14px;
      color: #555;
      margin-bottom: 30px;
    }
    .footer {
      font-size: 12px;
      color: #aaa;
      margin-top: 40px;
    }
    button {
      background-color: #4285f4;
      color: white;
      border: none;
      padding: 10px 20px;
      font-size: 14px;
      border-radius: 5px;
      cursor: pointer;
      margin-top: 10px;
    }
    button:hover {
      background-color: #3367d6;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="logo" onclick="downloadInvoice()">
      <img src="https://upload.wikimedia.org/wikipedia/commons/2/2f/Google_2015_logo.svg" alt="Google Logo" />
    </div>
    <div class="success">
      Payment Successful<br />
      <small>Click the Google logo above to download your invoice</small>
    </div>
    <div class="details">
      Invoice sent to <strong>monsterprince3633@gmail.com</strong><br />
      Thank you for your purchase!
    </div>

    <!-- Button to create sample invoice data for testing -->
    <button onclick="setSampleInvoiceData()">Set Sample Invoice Data</button>

    <div class="footer">
      Â© 2025 Google LLC. All rights reserved.
    </div>
  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script>
    const { jsPDF } = window.jspdf;

    function setSampleInvoiceData() {
      const sampleData = {
        date: new Date().toISOString(),
        orderId: 'ORD123456789',
        email: 'monsterprince3633@gmail.com',
        items: [
          { name: 'Google Workspace Basic Plan', price: 99.99 },
          { name: 'Additional Storage', price: 19.99 },
        ],
        total: 119.98,
      };
      localStorage.setItem('invoice', JSON.stringify(sampleData));
      alert('Sample invoice data has been saved in localStorage.\nNow click the Google logo to download the invoice PDF.');
    }

    function downloadInvoice() {
      const data = JSON.parse(localStorage.getItem('invoice'));
      if (!data) return alert('Invoice data not found. Please set sample data first.');

      const doc = new jsPDF();

      // Use PNG version of Google logo
      const logoUrl = "https://upload.wikimedia.org/wikipedia/commons/thumb/2/2f/Google_2015_logo.svg/320px-Google_2015_logo.svg.png";

      // To use an image URL in jsPDF, we need to convert it to base64 asynchronously
      // So we create a helper to convert image URL to base64 then generate the PDF

      convertImgToBase64(logoUrl, function(base64Img) {
        doc.addImage(base64Img, "PNG", 15, 10, 40, 12);

        doc.setFont("Helvetica");
        doc.setFontSize(18);
        doc.setTextColor(33, 33, 33);
        doc.text("Payment Invoice", 105, 25, { align: "center" });

        doc.setFontSize(12);
        doc.setTextColor(0);

        // Invoice Header
        doc.text(`Invoice Date: ${new Date(data.date).toLocaleDateString()}`, 15, 40);
        doc.text(`Order ID: ${data.orderId}`, 15, 48);
        doc.text(`Billed To: ${data.email}`, 15, 56);

        // Item Table Header
        let y = 70;
        doc.setDrawColor(200);
        doc.setLineWidth(0.5);
        doc.line(15, y - 6, 195, y - 6);

        doc.setFont(undefined, "bold");
        doc.text("Item Description", 15, y);
        doc.text("Amount (USD)", 180, y, { align: "right" });

        doc.setFont(undefined, "normal");
        y += 10;

        // Table Rows
        data.items.forEach(item => {
          doc.text(item.name, 15, y);
          doc.text(`$${item.price.toFixed(2)}`, 180, y, { align: "right" });
          y += 8;
        });

        // Total
        doc.setFont(undefined, "bold");
        doc.text("Total", 15, y + 6);
        doc.text(`$${data.total}`, 180, y + 6, { align: "right" });

        y += 20;

        // Footer Info
        doc.setFontSize(10);
        doc.setTextColor(100);
        doc.text("This invoice is generated for your payment made through Google services.", 15, y);
        y += 6;
        doc.text("Please retain this document for your records. For any disputes, contact support within 7 days.", 15, y);
        y += 6;
        doc.text("For support: https://support.google.com", 15, y);

        y += 12;
        doc.text("Google LLC", 15, y);
        doc.text("1600 Amphitheatre Parkway, Mountain View, CA 94043, USA", 15, y + 6);
        doc.text("Tax ID: 123-456789", 15, y + 12);

        doc.save("Google_Invoice.pdf");
      });
    }

    // Helper: Convert image URL to base64 for jsPDF
    function convertImgToBase64(url, callback, outputFormat){
      var img = new Image();
      img.crossOrigin = 'Anonymous';
      img.onload = function(){
        var canvas = document.createElement('canvas');
        canvas.width = this.width;
        canvas.height = this.height;
        var ctx = canvas.getContext('2d');
        ctx.drawImage(this, 0, 0);
        var dataURL = canvas.toDataURL(outputFormat || 'image/png');
        callback(dataURL);
      };
      img.onerror = function() {
        alert('Failed to load logo image for invoice.');
      }
      img.src = url;
    }
  </script>
</body>
</html>
